<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright 2009 XBRL International. All Rights Reserved. -->
<?xml-stylesheet type="text/xsl" href="../stylesheets/conformanceFunction.xsl"?>
<testcase
  xmlns="http://xbrl.org/2008/conformance"
  xmlns:reg="http://xbrl.org/2008/registry"
  xmlns:fcn="http://xbrl.org/2008/function"
  xmlns:cfcn="http://xbrl.org/2008/conformance/function"
  xmlns:xbrli="http://www.xbrl.org/2003/instance"
  xmlns:xhtml="http://www.w3.org/1999/xhtml"
  xmlns:xfi="http://www.xbrl.org/2008/function/instance" 
  xmlns:xfie="http://www.xbrl.org/2008/function/instance/error" 
  xmlns:xqt-err="http://www.w3.org/2005/xqt-errors"
  xmlns:eg="http://xbrl.org/formula/conformance/example" 
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xsi:schemaLocation="
  http://xbrl.org/2008/registry ../schemas/registry.xsd
  http://xbrl.org/2008/function ../schemas/function.xsd
  http://xbrl.org/2008/conformance ../schemas/conformance.xsd
  http://xbrl.org/2008/conformance/function ../schemas/conformanceFunction.xsd
  ">
  <owners>
    <reg:owner id="herm">
      <reg:name>Herm Fischer</reg:name>
      <reg:affiliation>Mark V Systems</reg:affiliation>
      <reg:email>fischer@markv.com</reg:email>
     <reg:assumedOwnership moment="2012-09-13T22:00:00" />
    </reg:owner>
    <reg:owner id="rna">
      <reg:name>Richard Ashby</reg:name>
      <reg:affiliation>CoreFiling</reg:affiliation>
      <reg:email>rna@corefiling.com</reg:email>
     <reg:assumedOwnership moment="2013-07-24T14:00:00" />
    </reg:owner>
  </owners>

  <number>90801</number>

  <name>Function test xfi:create-element</name>

  <documentation>
    <xhtml:p>
      Tests of xfi:create-element($name as xs:QName, $attributes as xs:anyAtomicType*, $value as xs:anyAtomicType?, children as xs:element()*) as xs:element()
      </xhtml:p>
    <xhtml:p>
      The xfi:create-element function can only be applied to fact generation typed dimension and OCC rules for output instances.  The funcion testcase checks creation in absence of an output instance so is of limited use.
      </xhtml:p>
      <xhtml:p>
      There is a formula test case provided in this directory for output instance testing,
      and it is listed as a testcase in the trunk/index.xml testcases file, to cause its execution.
      </xhtml:p>
  </documentation>

  <reference xlink:type="simple" xlink:href="http://www.xbrl.org/Specification/XF-PWD-2006-12-07.htm#_Toc152670684"/>

  <variation id="V-01">
    <name>Function creates a string element.</name>
    <documentation>
      <xhtml:p>
      </xhtml:p>
    </documentation>

    <inputs>
      <schema xlink:type="simple" xlink:href="elt-creation-tests.xsd"/>
      <instance readMeFirst="true" id="V01" xlink:type="simple" xlink:href="create-typed-dim-string-instance.xml"/>
      <cfcn:call file="V01">
         xfi:create-element(xs:QName("eg:typedDim1Value"),(),'this is a test of xml element creation')
      </cfcn:call>
    </inputs>
    <outputs>
      <cfcn:test>
         $result instance of element(eg:typedDim1Value) and 
         count( $result ) eq 1 and 
         $result eq "this is a test of xml element creation" 
      </cfcn:test>
    </outputs>
  </variation>

  <variation id="V-02">
    <name>Element name is not a QName</name>
    <documentation>
      <xhtml:p>
        XPath-defined error for type of argument.
      </xhtml:p>
    </documentation>
    <inputs>
      <schema xlink:type="simple" xlink:href="elt-creation-tests.xsd"/>
      <instance readMeFirst="true" id="V02" xlink:type="simple" xlink:href="create-typed-dim-string-instance.xml"/>
      <cfcn:call file="V02">
         xfi:create-element( 'hello I am not a QName', () )
      </cfcn:call>
    </inputs>
    <outputs>
      <error>xqt-err:XPTY0004</error>
    </outputs>
  </variation>

  <variation id="V-03">
    <name>Attributes argument must be pairs of name, value.</name>
    <documentation>
      <xhtml:p>
      </xhtml:p>
    </documentation>

    <inputs>
      <schema xlink:type="simple" xlink:href="elt-creation-tests.xsd"/>
      <instance readMeFirst="true" id="V03" xlink:type="simple" xlink:href="create-typed-dim-string-instance.xml"/>
      <cfcn:call file="V03">
         xfi:create-element( xs:QName("eg:typedDim1Value"), ('attr1','val1','attr2withoutvalue'), () )
      </cfcn:call>
    </inputs>
    <outputs>
      <error>xfie:AttributesNotNameValuePairs</error>
    </outputs>
  </variation>

  <variation id="V-04">
    <name>Attributes argument must be pairs of name, value.</name>
    <documentation>
      <xhtml:p>
      </xhtml:p>
    </documentation>

    <inputs>
      <schema xlink:type="simple" xlink:href="elt-creation-tests.xsd"/>
      <instance readMeFirst="true" id="V04" xlink:type="simple" xlink:href="create-typed-dim-string-instance.xml"/>
      <cfcn:call file="V04">
         xfi:create-element( xs:QName("eg:typedDim1Value"), ('attr1',123, 456, 'attr2nameAfterValue') )
      </cfcn:call>
    </inputs>
    <outputs>
      <error>xfie:AttributesNotNameValuePairs</error>
    </outputs>
  </variation>


  <variation id="V-05">
    <name>Attribute qualified name must be QName not prefixed string.</name>
    <documentation>
      <xhtml:p>
      </xhtml:p>
    </documentation>

    <inputs>
      <schema xlink:type="simple" xlink:href="elt-creation-tests.xsd"/>
      <instance readMeFirst="true" id="V05" xlink:type="simple" xlink:href="create-typed-dim-string-instance.xml"/>
      <cfcn:call file="V05">
         xfi:create-element( xs:QName("eg:typedDim1Value"), ('attr1',123, 'xlink:role', 'http://myrole') )
      </cfcn:call>
    </inputs>
    <outputs>
      <error>xfie:AttributesNotNameValuePairs</error>
    </outputs>
  </variation>


  <variation id="V-06">
    <name>Mixed content raises an error.</name>
    <documentation>
      <xhtml:p>
      </xhtml:p>
    </documentation>

    <inputs>
      <schema xlink:type="simple" xlink:href="elt-creation-tests.xsd"/>
      <instance readMeFirst="true" id="V06" xlink:type="simple" xlink:href="create-typed-dim-string-instance.xml"/>
      <cfcn:call file="V06">
         xfi:create-element( xs:QName("eg:t"), ('a',123), 'big world',
                (xfi:create-element( xs:QName("eg:t"), ('a',456), 'small world 1'),
                 xfi:create-element( xs:QName("eg:t"), ('a',789), 'small world 2'))
                )
      </cfcn:call>
    </inputs>
    <outputs>
      <error>xfie:MixedContentError</error>
    </outputs>
  </variation>


  <revisions>
    <reg:revision on="2012-09-13T22:00:00" by="herm">
      <xhtml:p>
        Created the test case.
      </xhtml:p>
    </reg:revision>
    <reg:revision on="2013-07-20T14:00:00" by="herm">
      <xhtml:p>
        Renamed function xfi:create-element from xfi:create-element.
      </xhtml:p>
    </reg:revision>
    <reg:revision on="2013-07-24T14:00:00" by="rna">
      <xhtml:p>
        Updated variations V-03 and V-04 to avoid spurious errors from empty xs:QName() constructor. 
      </xhtml:p>
    </reg:revision>
    <reg:revision on="2013-08-14T14:00:00" by="herm">
      <xhtml:p>
        Added V-05, example where a qualified attribute name is a prefixed string with a colon (instead of QName), and V-06, where mixed content is provided.
      </xhtml:p>
    </reg:revision>
  </revisions>

</testcase>
