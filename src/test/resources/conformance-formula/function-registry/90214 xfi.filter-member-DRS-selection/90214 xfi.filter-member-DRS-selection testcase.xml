<!-- Copyright 2008 XBRL International. All Rights Reserved. -->
<?xml-stylesheet type="text/xsl" href="../stylesheets/conformanceFunction.xsl"?>
<testcase
  xmlns="http://xbrl.org/2008/conformance"
  xmlns:reg="http://xbrl.org/2008/registry"
  xmlns:fcn="http://xbrl.org/2008/function"
  xmlns:cfcn="http://xbrl.org/2008/conformance/function"
  xmlns:xbrli="http://www.xbrl.org/2003/instance"
  xmlns:xhtml="http://www.w3.org/1999/xhtml"
  xmlns:xfi="http://www.xbrl.org/2008/function/instance"
  xmlns:xfie="http://www.xbrl.org/2008/function/instance/error"
  xmlns:xqt-err="http://www.w3.org/2005/xqt-errors"
  xmlns:concept="http://xbrl.org/formula/conformance/example" 
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xsi:schemaLocation="
  http://xbrl.org/2008/registry ../schemas/registry.xsd
  http://xbrl.org/2008/function ../schemas/function.xsd
  http://xbrl.org/2008/conformance ../schemas/conformance.xsd
  http://xbrl.org/2008/conformance/function ../schemas/conformanceFunction.xsd
  ">
  <owners>
    <reg:owner id="herm">
      <reg:name>Herm Fischer</reg:name>
      <reg:affiliation>Mark V Systems (formerly with UBmatrix)</reg:affiliation>
      <reg:email>fischer@markv.com</reg:email>
      <reg:assumedOwnership moment="2008-09-01T00:00:00" />
    </reg:owner>
  </owners>

  <number>90214</number>

  <name>xfi:filter-member-DRS-selection</name>

  <documentation>

    <xhtml:p>
      Dimension tree-view of this testcase: 
    </xhtml:p>

    <xhtml:img src="../90213 xfi.filter-member-network-selection/filter-member-dimension-values.png" border="1"/>

    <xhtml:ul>
      <xhtml:li>
      <xhtml:i>primaryItems</xhtml:i> has the primary item used in dimension filter test instances (Peak), for an instance of mountain peaks each of a dimension of region and peak height, where this Peak primary item contains the mountain's name as its text.  The Peak concept primary item has an <xhtml:i>all</xhtml:i> relationship to the SummitHypercube.
      </xhtml:li>
      <xhtml:li>
      <xhtml:i>hypercubes</xhtml:i> has the SummitHypercube and an explicit dimension, Location, arranged in hierarchy of regions each in separate extended link.
      </xhtml:li>
      <xhtml:li>
      <xhtml:i>regions</xhtml:i> breaks down into continents into countries, each in their own dimension as a DRS.  This allows demonstrating the use of member hierarchies in a DRS with use of targetRole to assemble connected relationships.
      </xhtml:li>
    </xhtml:ul>
  </documentation>

  <reference
    xlink:type="simple"
    xlink:href="90211 xfi.filter-member-network-selection function.xml">
    function definition  
  </reference>

  <variation id="V-01">
    <name>A list of members of North America</name>
    <documentation>
      <xhtml:p>
        Peak(primaryItems)-&gt;SummitHypercube(hypercubes)-&gt;Location-&gt;Regions(regions)-&gt;America(americas)-&gt;NorthAmerica-&gt;(UnitedStates,Mexico,Canada). 
        The test is organized to be insensitive to the order of returned
        member items, though the XPath 2 sequence operators mostly assure
        that it be in document order.
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V01" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V01">
        xfi:filter-member-DRS-selection(
          xs:QName('concept:Location'),
          xs:QName('concept:Peak'),
          xs:QName('concept:NorthAmerica'),
          "http://xbrl.org/formula/conformance/example/role/primaryItems",
          'DRS-descendant'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <cfcn:test>
         $result instance of xs:QName* and
         count( $result ) eq 3 and
         index-of($result,
             QName('http://xbrl.org/formula/conformance/example','concept:Mexico')) and
         index-of($result,
             xs:QName('concept:Canada')) and
         index-of($result,
             QName('http://xbrl.org/formula/conformance/example','concept:UnitedStates'))
      </cfcn:test>
    </outputs>
  </variation>

  <variation id="V-02">
    <name>Same as V-01 but absent linkrole</name>
    <documentation>
      <xhtml:p>
        Linkrole is omitted by being an empty string
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V02" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V02">
        xfi:filter-member-DRS-selection(
          xs:QName('concept:Location'),
          xs:QName('concept:Peak'),
          xs:QName('concept:NorthAmerica'),
          "",
          'DRS-descendant'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <cfcn:test>
         $result instance of xs:QName* and
         count( $result ) eq 3 and
         index-of($result,
             QName('http://xbrl.org/formula/conformance/example','concept:Mexico')) and
         index-of($result,
             xs:QName('concept:Canada')) and
         index-of($result,
             QName('http://xbrl.org/formula/conformance/example','concept:UnitedStates'))
      </cfcn:test>
    </outputs>
  </variation>

  <variation id="V-03">
    <name>Same as V-01 but absent linkrole</name>
    <documentation>
      <xhtml:p>
        Linkrole is omitted by being an empty sequence
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V03" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V03">
        xfi:filter-member-DRS-selection(
          xs:QName('concept:Location'),
          xs:QName('concept:Peak'),
          xs:QName('concept:NorthAmerica'),
          ( ),
          'DRS-descendant'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <cfcn:test>
         $result instance of xs:QName* and
         count( $result ) eq 3 and
         index-of($result,
             QName('http://xbrl.org/formula/conformance/example','concept:Mexico')) and
         index-of($result,
             xs:QName('concept:Canada')) and
         index-of($result,
             QName('http://xbrl.org/formula/conformance/example','concept:UnitedStates'))
      </cfcn:test>
    </outputs>
  </variation>

  <variation id="V-04">
    <name>A list of members of Oceania (2 levels of descendants)</name>
    <documentation>
      <xhtml:p>
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V04" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V04">
        xfi:filter-member-DRS-selection(
          xs:QName('concept:Location'),
          xs:QName('concept:Peak'),
          xs:QName('concept:Oceania'),
          ( ),
          'DRS-descendant'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <cfcn:test>
         $result instance of xs:QName* and
         count( $result ) eq 5 and
         index-of($result,
             xs:QName('concept:Australasia')) and
         index-of($result,
             xs:QName('concept:Australia')) and
         index-of($result,
             xs:QName('concept:NewZealand')) and
         index-of($result,
             xs:QName('concept:Melanesia')) and
         index-of($result,
             xs:QName('concept:Indonesia'))
      </cfcn:test>
    </outputs>
  </variation>

  <variation id="V-05">
    <name>A list of Oceania child subregions</name>
    <documentation>
      <xhtml:p>
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V05" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V05">
        xfi:filter-member-DRS-selection(
          xs:QName('concept:Location'),
          xs:QName('concept:Peak'),
          xs:QName('concept:Oceania'),
          ( ),
          'DRS-child'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <cfcn:test>
         $result instance of xs:QName* and
         count( $result ) eq 2 and
         index-of($result,
             xs:QName('concept:Australasia')) and
         index-of($result,
             xs:QName('concept:Melanesia')) 
      </cfcn:test>
    </outputs>
  </variation>

  <variation id="V-06">
    <name>A list of Asia subregions with highest peaks</name>
    <documentation>
      <xhtml:p>
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V06" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V06">
        xfi:filter-member-DRS-selection(
          xs:QName('concept:Location'),
          xs:QName('concept:Peak'),
          xs:QName('concept:Asia'),
          ( ),
          'DRS-descendant'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <cfcn:test>
         $result instance of xs:QName* and
         count( $result ) eq 2 and
         index-of($result,
             xs:QName('concept:SouthAsia')) and
         index-of($result,
             xs:QName('concept:Nepal'))
      </cfcn:test>
    </outputs>
  </variation>

  <variation id="V-07">
    <name>A empty list of children of child-less member</name>
    <documentation>
      <xhtml:p>
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V07" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V07">
        xfi:filter-member-DRS-selection(
          xs:QName('concept:Location'),
          xs:QName('concept:Peak'),
          xs:QName('concept:Nepal'),
          ( ),
          'DRS-descendant'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <cfcn:test>
         empty( $result )
      </cfcn:test>
    </outputs>
  </variation>

  <variation id="V-08">
    <name>Nothing found if non-member concept as the member argument</name>
    <documentation>
      <xhtml:p>
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V08" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V08">
        xfi:filter-member-DRS-selection(
          xs:QName('concept:Location'),
          xs:QName('concept:Peak'),
          xs:QName('concept:Mars'),
          ( ),
          'DRS-descendant'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <cfcn:test>
         empty( $result )
      </cfcn:test>
    </outputs>
  </variation>

  <variation id="V-09">
    <name>Nothing found if non-dimension concept as the dimension argument</name>
    <documentation>
      <xhtml:p>
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V09" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V09">
        xfi:filter-member-DRS-selection(
          xs:QName('concept:Mars'),
          xs:QName('concept:Peak'),
          xs:QName('concept:Nepal'),
          ( ),
          'DRS-descendant'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <cfcn:test>
         empty( $result )
      </cfcn:test>
    </outputs>
  </variation>

  <variation id="V-10">
    <name>Nothing found if concept without any has-hypercube relationships is used as the primary item argument</name>
    <documentation>
      <xhtml:p>
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V10" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V10">
        xfi:filter-member-DRS-selection(
          xs:QName('concept:Location'),
          xs:QName('concept:Mars'),
          xs:QName('concept:Nepal'),
          ( ),
          'DRS-descendant'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <cfcn:test>
         empty( $result )
      </cfcn:test>
    </outputs>
  </variation>

  <variation id="V-11">
    <name>Error of non-XBRL element as any of the arguments</name>
    <documentation>
      <xhtml:p>
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V11" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V11">
        xfi:filter-member-DRS-selection(
          xs:QName('concept:nonXbrlElement'),
          xs:QName('concept:nonXbrlElement'),
          xs:QName('concept:nonXbrlElement'),
          ( ),
          'DRS-descendant'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <cfcn:test>
         empty( $result )
      </cfcn:test>
    </outputs>
  </variation>

  <variation id="V-12">
    <name>Raises an error for an attribute declaration dimension argument</name>
    <documentation>
      <xhtml:p>
        Tests that error is detected when the dimension name argument declares an attribute.
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V12" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V12">
        xfi:filter-member-DRS-selection(
          xs:QName('concept:anAttribute'),
          xs:QName('concept:Peak'),
          xs:QName('concept:Nepal'),
          ( ),
          'DRS-descendant'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <error>xfie:invalidDimensionQName</error>
    </outputs>
  </variation>

  <variation id="V-13">
    <name>Raises an error for an attribute declaration primary item argument</name>
    <documentation>
      <xhtml:p>
        Tests that error is detected when the primary item name argument declares an attribute.
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V13" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V13">
        xfi:filter-member-DRS-selection(
          xs:QName('concept:Location'),
          xs:QName('concept:anAttribute'),
          xs:QName('concept:Nepal'),
          ( ),
          'DRS-descendant'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <error>xfie:invalidPrimaryItemConceptQName</error>
    </outputs>
  </variation>

  <variation id="V-14">
    <name>Raises an error for an xbrli namespace&apos;ed argument</name>
    <documentation>
      <xhtml:p>
        Tests that error is detected when the dimension qname is xbrli:item
      </xhtml:p>
     </documentation>
      
    <inputs>
      <schema readMeFirst="true" id="V14" xlink:type="simple" xlink:href="filter-member-dimension-values.xsd"/>
      <linkbase xlink:type="simple" xlink:href="filter-member-dimension-values-definition.xml"/>
      <cfcn:call file="V14">
        xfi:filter-member-DRS-selection(
          xs:QName('xbrli:item'), 
          xs:QName('concept:Peak'),
          xs:QName('concept:Nepal'),
          ( ),
          'DRS-descendant'
          )
      </cfcn:call>
    </inputs>
    <outputs>
      <error>xfie:invalidDimensionQName</error>
    </outputs>
  </variation>


  <revisions>
    <reg:revision on="2011-07-18T00:00:00" by="herm">
      <xhtml:p>
        Created the test case (using filter-member-network-selection example).
      </xhtml:p>
    </reg:revision>

  </revisions>
</testcase>
