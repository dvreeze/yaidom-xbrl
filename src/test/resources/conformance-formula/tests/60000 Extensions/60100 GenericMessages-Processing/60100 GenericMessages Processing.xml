<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright 2008 XBRL International. All Rights Reserved. -->
<?xml-stylesheet type="text/xsl" href="../../../infrastructure/test.xsl"?>
<testcase
  xmlns="http://xbrl.org/2008/conformance"
  xmlns:xbrli="http://www.xbrl.org/2003/instance"
  xmlns:xfi="http://www.xbrl.org/2008/function/instance"
  xmlns:xfie="http://www.xbrl.org/2008/function/instance/error"
  xmlns:xqt-err="http://www.w3.org/2005/xqt-errors"
  xmlns:xbrlmsge="http://xbrl.org/2010/message/error"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="
    http://xbrl.org/2008/conformance   ../../../infrastructure/test.xsd
  ">
  <creator>
    <name>Herm Fischer</name>
    <email>fischer@markv.com</email>
  </creator>

  <number>60100</number>

  <name>Generic Expression Messages</name>

  <description>
    Tests generic expression messages.
  </description>

  <variation id="V-01">
    <name>A simple fact with satisfied and not satisfied messages</name>
    <description>
       The expressions in the message show variable node-name, value, contextRef and period dates.
     </description>
      
    <data>
      <schema>gml-test1.xsd</schema>
      <linkbase>generic-msg-test1-formula.xml</linkbase>
      <instance readMeFirst="true">gml-test1-instance.xml</instance>
    </data>
    <result>
      <assertionTests 
         assertionID="test-assertion"
         countSatisfied="1"
         countNotSatisfied="1" />
      <messageTests 
         assertionID="test-assertion">
         <satisfied xml:lang="en">Satisfied: Fact test:A in context D-2001, reported value 987654321, for the period starting 2001-01-01 and ending 2001-12-31</satisfied>
         <notSatisfied xml:lang="en">Not satisfied error: Fact test:A in context D-2000, reported value 1000000, for the period starting 2000-01-01 and ending 2000-12-31</notSatisfied>
      </messageTests>
    </result>
  </variation>
  
  <variation id="V-02">
    <name>Same as V-01 but using xff:uncovered-aspect function</name>
    <description>
       The uncovered-aspect function is used to obtain the concept and period aspects.
     </description>
      
    <data>
      <schema>gml-test1.xsd</schema>
      <linkbase>generic-msg-test2-formula.xml</linkbase>
      <instance readMeFirst="true">gml-test2-instance.xml</instance>
    </data>
    <result>
      <assertionTests 
         assertionID="test-assertion"
         countSatisfied="0"
         countNotSatisfied="1" />
      <messageTests  assertionID="test-assertion">
         <notSatisfied xml:lang="en">Not satisfied error: Fact test:A in context D-2000, reported value 1000000, for the period starting 2000-01-01 and ending 2000-12-31</notSatisfied>
      </messageTests>
    </result>
  </variation>

  <variation id="V-02a">
    <name>Same as V-02 but xff:uncovered-aspect function fails with implicit filtering false</name>
    <description>
       The uncovered-aspect function raises an error due to implicit filtering being false.
     </description>
      
    <data>
      <schema>gml-test1.xsd</schema>
      <linkbase>generic-msg-test2a-formula.xml</linkbase>
      <instance readMeFirst="true">gml-test2a-instance.xml</instance>
    </data>
    <result>
      <error xmlns:xffe="http://www.xbrl.org/2010/function/formula/error">xffe:invalidFunctionUse</error>
    </result>
  </variation>

  <variation id="V-03">
    <name>Same as V-01 but variable name does not exist</name>
    <description>
       An XPath variable name does not exist, which raises an XPath 2 static compilation error.
     </description>
      
    <data>
      <schema>gml-test1.xsd</schema>
      <linkbase>generic-msg-test3-formula.xml</linkbase>
      <instance readMeFirst="true">gml-test3-instance.xml</instance>
    </data>
    <result>
      <error>xqt-err:XPST0008</error>
    </result>
  </variation>
  
  <variation id="V-04">
    <name>Same as V-01 but XPath has a syntax error</name>
    <description>
       An XPath syntax error raises an XPath 2 static compilation error.
     </description>
      
    <data>
      <schema>gml-test1.xsd</schema>
      <linkbase>generic-msg-test4-formula.xml</linkbase>
      <instance readMeFirst="true">gml-test4-instance.xml</instance>
    </data>
    <result>
      <error>xqt-err:XPST0003</error>
    </result>
  </variation>
  
  <variation id="V-05">
    <name>Same as V-01 but missing right curly bracket</name>
    <description>
       Missing right curly bracket error.
     </description>
      
    <data>
      <schema>gml-test1.xsd</schema>
      <linkbase>generic-msg-test5-formula.xml</linkbase>
      <instance readMeFirst="true">gml-test5-instance.xml</instance>
    </data>
    <result>
      <error>xbrlmsge:missingRightCurlyBracketInMessage</error>
    </result>
  </variation>
  
  <variation id="V-06">
    <name>Same as V-01 but missing left curly bracket</name>
    <description>
       Missing left curly bracket error.
     </description>
      
    <data>
      <schema>gml-test1.xsd</schema>
      <linkbase>generic-msg-test6-formula.xml</linkbase>
      <instance readMeFirst="true">gml-test6-instance.xml</instance>
    </data>
    <result>
      <error>xbrlmsge:missingLeftCurlyBracketInMessage</error>
    </result>
  </variation>
  
 <!-- Error code not defined in REC edition of Spec, test disabled pending addition to PER.
   <variation id="V-07">
    <name>Validation message missing required xml:lang</name>
    <description>
       Validation message missing required xml:lang
     </description>
      
    <data>
      <schema>gml-test1.xsd</schema>
      <linkbase readMeFirst="true">generic-msg-test7-formula.xml</linkbase>
    </data>
    <result>
      <error>xbrlmsge:missingMessageLanguage</error>
    </result>
  </variation>
   -->
   
   <variation id="V-08">
    <name>Existence assertion contains invalid reference to variable set variable</name>
    <description>
       Existence assertion contains invalid reference to variable set variable.
     </description>
      
    <data>
      <schema>gml-test1.xsd</schema>
       <linkbase>generic-msg-test8-formula.xml</linkbase>
       <instance readMeFirst="true">gml-test8-instance.xml</instance>
    </data>
    <result>
      <error>xqt-err:XPST0008</error>
    </result>
  </variation>
  
    <variation id="V-09">
    <name>Existence assertion using in scope variables</name>
    <description>
       Existence assertion using in scope variables
     </description>
      
    <data>
      <schema>gml-test1.xsd</schema>
      <linkbase>generic-msg-test9-formula.xml</linkbase>
      <instance readMeFirst="true">gml-test9-instance.xml</instance>
    </data>
    <result>
      <assertionTests 
         assertionID="test-assertion"
         countSatisfied="0"
         countNotSatisfied="1" />
      <messageTests assertionID="test-assertion">
         <notSatisfied xml:lang="en">Not satisfied error: The expression '. ge $v:existenceMinOccurs and . le $maxOccurs' was not satisfied. Number of evaluations was: 1. Max occurs param was: 100.</notSatisfied>
      </messageTests>
    </result>
  </variation>
  
</testcase>


